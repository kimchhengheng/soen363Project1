--G
CREATE VIEW MIN_RATING_EACH_YEAR AS
SELECT YEAR AS YEAR, MIN(RATING) AS MIN_RATING
        FROM MOVIES
        WHERE YEAR BETWEEN 2005 AND 2011
        GROUP BY YEAR;

CREATE VIEW MAX_RATING_EACH_YEAR AS
SELECT YEAR, MAX(RATING) AS MAX_RATING
        FROM MOVIES
        WHERE YEAR BETWEEN 2005 AND 2011
        GROUP BY YEAR;

SELECT T.YEAR, T.TITLE, T.RATING
FROM ( SELECT TEMP.YEAR, M.TITLE, M.RATING
       FROM MOVIES M, MIN_RATING_EACH_YEAR TEMP
       WHERE M.RATING = TEMP.MIN_RATING AND M.YEAR = TEMP.YEAR
       UNION
       SELECT TEMP.YEAR, M.TITLE, M.RATING
       FROM MOVIES M, MAX_RATING_EACH_YEAR TEMP
       WHERE M.RATING = TEMP.MAX_RATING AND M.YEAR = TEMP.YEAR) T
ORDER BY T.YEAR ASC, T.RATING ASC, T.TITLE ASC;