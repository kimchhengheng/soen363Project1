--K
-- K 1
SELECT  CA.TOM, COUNT(*)      
FROM   (SELECT DISTINCT A1.NAME AS TOM, A2.NAME
        FROM MOVIES M, ACTORS A1, ACTORS A2
        WHERE A1.NAME = 'Tom Cruise' AND A1.MID = M.MID AND A2.MID=M.MID AND A2.NAME <> A1.NAME) CA
GROUP BY CA.TOM;

-- K 2
CREATE VIEW NUM_COACTORS_PER_ACTOR AS
SELECT CA.MAIN_ACTOR, COUNT(*) AS NUM_CA     
FROM   (SELECT DISTINCT A1.NAME AS MAIN_ACTOR, A2.NAME
        FROM MOVIES M, ACTORS A1, ACTORS A2
        WHERE A1.MID = M.MID AND A2.MID=M.MID AND A2.NAME <> A1.NAME) CA 
GROUP BY CA.MAIN_ACTOR;

SELECT *
FROM NUM_COACTORS_PER_ACTOR
WHERE NUM_CA = (SELECT MAX(NUM_CA) FROM NUM_COACTORS_PER_ACTOR)
ORDER BY MAIN_ACTOR ASC;