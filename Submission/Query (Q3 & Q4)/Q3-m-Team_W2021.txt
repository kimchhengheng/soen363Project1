-- M
-- FINDING OUT WHICH TABLES HAVE DUPLICATES
-- ASSUMPTION: TO FIND THE DUPLICATES, WE ARE CONSIDERING ALL ATTRIBUTES EXCEPT THE PRIMARY KEY WHERE IT WAS DEFINED

-- ACTORS HAS NO DUPLICATES
SELECT MID, NAME, CAST_POSITION
FROM ACTORS
GROUP BY MID, NAME, CAST_POSITION
HAVING COUNT(*) > 1;

-- MOVIES HAS DUPLICATES
SELECT TITLE, YEAR, RATING, NUM_RATING
FROM MOVIES
GROUP BY TITLE, YEAR, RATING, NUM_RATING
HAVING COUNT(*) > 1;

-- GENRES HAS NO DUPLICATES
SELECT MID, GENRE
FROM GENRES
GROUP BY MID, GENRE
HAVING COUNT(*) > 1;

-- TAGS HAS NO DUPLICATES
SELECT MID, TID
FROM TAGS
GROUP BY MID, TID
HAVING COUNT(*) > 1;

-- TAG_NAMES
SELECT TID, TAG
FROM TAG_NAMES
GROUP BY TID, TAG
HAVING COUNT(*) > 1;

--LIST OF TABLE THAT HAVE DUPLICATES
-- 1. MOVIES

CREATE VIEW MOVIES_NO_DUPLICATE AS
SELECT * 
FROM ((
    SELECT  TITLE, YEAR, RATING, NUM_RATING FROM MOVIES
        MINUS
    SELECT TITLE, YEAR, RATING, NUM_RATING FROM MOVIES
    GROUP BY TITLE, YEAR, RATING, NUM_RATING
    HAVING COUNT(*) > 1
    ) 
    UNION
SELECT TITLE, YEAR, RATING, NUM_RATING FROM MOVIES
GROUP BY TITLE, YEAR, RATING, NUM_RATING
HAVING COUNT(*) > 1
);