--H
-- H I
CREATE VIEW HIGH_RATING AS
SELECT DISTINCT A.NAME AS HR_NAME
FROM MOVIES M, ACTORS A
WHERE M.MID = A.MID AND M.RATING >=4;

CREATE VIEW LOW_RATING AS
SELECT DISTINCT A.NAME AS LR_NAME
FROM MOVIES M, ACTORS A
WHERE M.MID = A.MID AND M.RATING <4;

SELECT COUNT(*) AS NUM_HR FROM HIGH_RATING;
SELECT COUNT(*) AS NUM_LR FROM LOW_RATING;

-- H II
-- MINUS IS EQUIVALENT TO KEYWORD EXCEPT. IT IS FOR SET DIFFERENCE.
CREATE VIEW NO_FLOP_ACTORS AS
    SELECT *
    FROM HIGH_RATING
    MINUS
    SELECT *
    FROM LOW_RATING;
	
SELECT COUNT(*)
FROM NO_FLOP_ACTORS;

-- H III
SELECT *
FROM (
         SELECT NFA.HR_NAME , COUNT(*) AS NUM_MOVIES
         FROM MOVIES M, NO_FLOP_ACTORS NFA, ACTORS A
         WHERE M.MID = A.MID AND A.NAME =NFA.HR_NAME
         GROUP BY NFA.HR_NAME
         ORDER BY NUM_MOVIES DESC) T
WHERE ROWNUM<=10;